<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE struts-config PUBLIC
      "-//Apache Software Foundation//DTD Struts Configuration 1.1//EN"
      "http://jakarta.apache.org/struts/dtds/struts-config_1_1.dtd">
<struts-config>

    <!-- ========== Data Source Configuration =============================== -->
    <data-sources />

    <!-- ========== Form Bean Definitions ================================== -->
    <form-beans type="org.apache.struts.action.ActionFormBean">
        <form-bean name="authenticationForm"
				type="org.apache.struts.validator.DynaValidatorForm" 
            	dynamic="true">
            <form-property name="username" type="java.lang.String" />
            <form-property name="password" type="java.lang.String" />
        </form-bean>
      <form-bean name="authenticationExpiredForm" 
                 type="org.apache.struts.validator.DynaValidatorForm"
                 dynamic="true">
        <form-property name="username" type="java.lang.String" />                 
        <form-property name="password" type="java.lang.String" />
        <form-property name="newPassword" type="java.lang.String" />
        <form-property name="reTypeNewPassword" type="java.lang.String" />
        <form-property name="page" type="java.lang.Integer" />
        <form-property name="fromCAS" type="java.lang.String" />
      </form-bean>        
        <form-bean name="errorMailForm"
				type="org.apache.struts.validator.DynaValidatorForm" 
            	dynamic="true">
            <form-property name="email" type="java.lang.String" />
            <form-property name="subject" type="java.lang.String" />
            <form-property name="body" type="java.lang.String" />
        </form-bean>
		<form-bean name="changeLocaleForm"
				type="org.apache.struts.validator.DynaValidatorForm"
				dynamic="true">
	   		<form-property name="windowLocation" type="java.lang.String"/>
   			<form-property name="newLanguage" type="java.lang.String"/>
   			<form-property name="newCountry" type="java.lang.String"/>
   			<form-property name="newVariant" type="java.lang.String"/>
		</form-bean>
    </form-beans>

    <!-- ========== Global Exception Definitions ============================== -->
	<global-exceptions>
        <exception type="java.lang.Exception"
				key="error.Exception"
            	handler="net.sourceforge.fenixedu.presentationTier.config.FenixContainerExceptionHandler"
			/>
		<exception type="net.sourceforge.fenixedu.applicationTier.Servico.exceptions.NotAuthorizedException"
				key="error.NotAuthorized"
				handler="net.sourceforge.fenixedu.presentationTier.config.FenixContainerExceptionHandler"
			/>
	</global-exceptions>

    <!-- ========== Global Forward Definitions =============================== -->
    <global-forwards type="org.apache.struts.action.ActionForward">
        <forward name="index" path="/index.do" redirect="true"/>
        <forward name="logoff" path="/logoff.do" contextRelative="true"/>
        <forward name="redirect" path="/redirect.do" contextRelative="true"/>
        <forward name="home" path="/mainPortalPage.jsp" redirect="true" contextRelative="true"/>
        <forward name="firstPage" path="/loginPage.jsp"/>
        <forward name="exceptionHandling" path="/exceptionHandlingAction.do?method=goBack" contextRelative="true"/>
    </global-forwards>

    <!-- ========== Action Mapping Definitions =============================== -->
    <action-mappings type="org.apache.struts.action.ActionMapping">
		<action path="/showErrorPage" forward="/exception/error.jsp"/>
		<action path="/showErrorPageRegistered" forward="/exception/errorRegistered.jsp"/>
        <action path="/naoAutorizado" forward="/error.jsp"/>
        <action path="/naoExecutado" forward="/error.jsp"/>
		<action path="/notAuthorized" forward="df.layout.notAuthorized"/>
        <action path="/autenticacao" forward="/autenticacao.jsp" />
        <action path="/naoExistente" forward="/error.jsp" />
        <action path="/nonExistingObject" forward="/nonExistingError.jsp"/>
        <action path="/publicNotAuthorized" forward="/exception/publicNotAuthorized.jsp"/>
        

	    <action path="/changeLocaleTo"
	    		name="changeLocaleForm"
	    		validate="false"
	    		type="net.sourceforge.fenixedu.presentationTier.Action.publico.ChangeLocale">
		    <forward name="something" path="/lalaland"/>
	    </action>

	    <action path="/siteMap"
	    		type="net.sourceforge.fenixedu.presentationTier.Action.SiteMapAction">
		    <forward name="site-map" path="/siteMap.jsp"/>
	    </action>

        <action path="/home"
				type="net.sourceforge.fenixedu.presentationTier.Action.base.FenixForwardAction" 
            	parameter="/messaging/index.do"/>
            	
        <action path="/login"
				type="net.sourceforge.fenixedu.presentationTier.Action.LocalAuthenticationAction"
            	name="authenticationForm"
				input="/loginPage.jsp"
				scope="request" 
            	className="net.sourceforge.fenixedu.presentationTier.mapping.ActionMappingForAuthentication">
            <exception type="net.sourceforge.fenixedu.applicationTier.Servico.exceptions.InvalidPasswordServiceException" 
                key="net.sourceforge.fenixedu.applicationTier.Servico.exceptions.InvalidPasswordServiceException" 
                handler="net.sourceforge.fenixedu.presentationTier.config.LoginInvalidPasswordExceptionHandler" />
			 <exception type="net.sourceforge.fenixedu.applicationTier.Servico.exceptions.PasswordExpiredServiceException" 
                key="net.sourceforge.fenixedu.applicationTier.Servico.exceptions.PasswordExpiredServiceException" 
                path="/loginExpired.do?method=start" />                
            <forward name="sucess" path="/home.do"/>
            <forward name="changePass" path="/person/changePasswordForward.do"/>
        </action>
        <action path="/loginCAS"
				type="net.sourceforge.fenixedu.presentationTier.Action.CASAuthenticationAction"
				scope="request">
            <forward name="sucess" path="/home.do" redirect="true"/>
            <forward name="error" path="/loginPage.jsp" redirect="true"/>
        </action>
        <action path="/redirect"
				type="net.sourceforge.fenixedu.presentationTier.Action.commons.LoginRedirectAction">
            <forward name="show-redirect-page" path="/redirect.jsp"/>
        </action>
       <action path="/loginExpired"
				type="net.sourceforge.fenixedu.presentationTier.Action.AuthenticationExpiredAction" 
            	name="authenticationExpiredForm"
            	parameter="method"
				input="/loginExpired.jsp"
				scope="request" >
            <forward name="sucess" path="/home.do"/>
            <forward name="changePass" path="/loginExpired.jsp"/>            
        </action>        
        <action path="/logoff"
				type="net.sourceforge.fenixedu.presentationTier.Action.commons.LogOffAction">
			<forward name="showLoginPage" path="/loginPage.jsp"/>
			<forward name="showBlankPage" path="/commons/blank.jsp"/>
        </action>
        <action path="/dotIstPortal" type="net.sourceforge.fenixedu.presentationTier.Action.base.FenixSwitchAction">
        </action>
        <action path="/exceptionHandlingAction"
				parameter="method"
				name="errorMailForm"
				scope="request" 
            	type="net.sourceforge.fenixedu.presentationTier.Action.ExceptionHandlingAction" >
        </action>
        <action path="/isAlive"
				type="net.sourceforge.fenixedu.presentationTier.Action.CheckIsAliveAction">
            <forward name="Success" path="/ok.jsp"/>
        </action>
        <action path="/checkPasswordKerberos"
				type="net.sourceforge.fenixedu.presentationTier.Action.CheckPasswordKerberosAction"
				scope="request">
			<exception type="net.sourceforge.fenixedu.presentationTier.Action.exceptions.NotAuthorizedActionException"
				key="error.NotAuthorized"
				path="/publicNotAuthorized.do"/>	
        </action>
    </action-mappings>

    <!-- ========== Controller Configuration ================================ -->
	<controller processorClass="net.sourceforge.fenixedu.presentationTier.processor.FenixRequestProcessorWithTiles"/>

    <!-- ========== Message Resources Definitions ============================ -->
	<message-resources parameter="resources.GlobalResources" key="GLOBAL_RESOURCES" null="false"/>
	<message-resources parameter="resources.ImageResources" key="IMAGE_RESOURCES" null="false"/>
	<message-resources parameter="resources.HtmlAltResources" key="HTMLALT_RESOURCES" null="false"/>
    <message-resources parameter="resources.ApplicationResources" null="false"/>
    <message-resources parameter="resources.PortalResources" key="PORTAL_RESOURCES" null="false"/>
    <message-resources parameter="resources.EnumerationResources" key="ENUMERATION_RESOURCES" null="false"/>
    <message-resources parameter="resources.StudentResources" key="STUDENT_RESOURCES" null="false"/>
    <message-resources parameter="resources.TeacherCreditsSheetResources" key="TEACHER_CREDITS_SHEET_RESOURCES" null="false"/>
    <message-resources parameter="resources.GEPResources" key="GEP_RESOURCES" null="false"/>
    <message-resources parameter="resources.DegreeAdministrativeOfficeResources" key="DEGREE_ADM_OFFICE" null="false"/>
	<message-resources parameter="resources.CurriculumHistoricResources" key="CURRICULUM_HISTORIC_RESOURCES" null="false"/>
	<message-resources parameter="resources.InquiriesResources" key="INQUIRIES_RESOURCES" null="false"/>
    <message-resources parameter="resources.PublicDegreeInformation" key="PUBLIC_DEGREE_INFORMATION" null="false"/>
   	<message-resources parameter="resources.ManagerResources" key="MANAGER_RESOURCES" null="false"/> 
   	<message-resources parameter="resources.DomainExceptionResources" key="DOMAIN_EXCEPTION_RESOURCES" null="false"/> 
    <message-resources parameter="resources.RendererResources" key="RENDERER_RESOURCES" null="false"/> 
    <message-resources parameter="resources.AdminOffice" key="ADMIN_OFFICE_RESOURCES" null="false"/>  
   	<message-resources parameter="resources.CandidateResources" key="CANDIDATE_RESOURCES" null="false" />     
	<message-resources parameter="resources.VigilancyResources" key="VIGILANCY_RESOURCES" null="false"/> 
   	<message-resources parameter="resources.TestsResources" key="TESTS_RESOURCES" null="false" />

    <!-- ========== Plug Ins Configuration ================================= -->
    <plug-in className="org.apache.struts.validator.ValidatorPlugIn">
        <set-property property="pathnames" value="/WEB-INF/validator-rules.xml,/WEB-INF/fenix-validator-rules.xml,/WEB-INF/conf/validation-default.xml"/>
    </plug-in>
    <plug-in className="org.apache.struts.tiles.TilesPlugin" >
        <set-property property="definitions-config" value="/WEB-INF/tiles/layouts/tiles-layout-definitions.xml" />
        <set-property property="moduleAware" value="true" />
        <set-property property="definitions-parser-validate" value="true" />
    </plug-in>
    
    <plug-in className="net.sourceforge.fenixedu.renderers.plugin.RenderersPlugin">
      <set-property property="config" value="/WEB-INF/fenix-renderers-config.xml"/>
      <set-property property="schemas" value="/WEB-INF/schemas/fenix-renderers-schemas.xml"/>
      <set-property property="metaObjectFactory" value="net.sourceforge.fenixedu.presentationTier.renderers.factories.FenixMetaObjectFactory"/>
      <set-property property="userIdentityFactory" value="net.sourceforge.fenixedu.presentationTier.renderers.factories.FenixUserIdentityFactory"/>
      <set-property property="schemaFactory" value="net.sourceforge.fenixedu.presentationTier.renderers.factories.FenixSchemaFactory"/>
    </plug-in>

</struts-config>
