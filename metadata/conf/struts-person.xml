<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE struts-config PUBLIC
      "-//Apache Software Foundation//DTD Struts Configuration 1.1//EN"
      "http://jakarta.apache.org/struts/dtds/struts-config_1_1.dtd">
<struts-config>
    
    <!-- ========== Data Source Configuration =============================== -->
    <data-sources />
    
    <!-- ========== Form Bean Definitions ================================== -->
    <form-beans type="org.apache.struts.action.ActionFormBean">
      
      <form-bean name="voidForm"
                 type="org.apache.struts.validator.DynaValidatorForm"
                 dynamic="true">
          <form-property name="voidProperty" type="java.lang.Integer" />
      </form-bean>
      
      <!-- Dynamic-FormBean for Password Change -->
      <form-bean name="changePasswordForm" 
                 type="org.apache.struts.validator.DynaValidatorForm"
                 dynamic="true">
        <form-property name="oldPassword" type="java.lang.String" />
        <form-property name="newPassword" type="java.lang.String" />
        <form-property name="reTypeNewPassword" type="java.lang.String" />
      </form-bean>

      <!-- Bean for change of Application Information -->
      <form-bean name="changePersonalInfoForm" 
                 type="org.apache.struts.validator.DynaValidatorForm"
                 dynamic="true">
            <form-property name="page" type="java.lang.Integer" />
        	
        	<form-property name="mobilePhone" type="java.lang.String" />
        	<form-property name="workPhone" type="java.lang.String" />
        	<form-property name="email" type="java.lang.String" />
        	<form-property name="availableEmail" type="java.lang.String" />
        	<form-property name="webSite" type="java.lang.String" />
        	<form-property name="availableWebSite" type="java.lang.String" />
			<form-property name="availablePhoto" type="java.lang.String" />
      </form-bean>

	  <!-- Dynamic-FormBean for Qualification Edit-->
      <form-bean name="qualificationForm" 
                 type="org.apache.struts.validator.DynaValidatorForm"
                 dynamic="true">
        <form-property name="tempDate" type="java.lang.String"/>
     	<form-property name="page" type="java.lang.Integer"/>
        <form-property name="idInternal" type="java.lang.Integer" initial="0"/>
        <form-property name="mark" type="java.lang.String" />
        <form-property name="school" type="java.lang.String" />
        <form-property name="degree" type="java.lang.String" />
        <form-property name="title" type="java.lang.String" />       
        <form-property name="branch" type="java.lang.String" />
        <form-property name="specializationArea" type="java.lang.String" />
        <form-property name="degreeRecognition" type="java.lang.String" />
        <form-property name="tempEquivalenceDate" type="java.lang.String" />
        <form-property name="equivalenceSchool" type="java.lang.String" />
        <form-property name="countryIdInternal" type="java.lang.Integer" />
        <form-property name="infoPerson#idInternal" type="java.lang.Integer" />
      </form-bean>

	  <!-- Dynamic-FormBean for Qualification Edit-->
      <form-bean name="sendSmsForm" 
                 type="org.apache.struts.validator.DynaValidatorForm"
                 dynamic="true">
     	<form-property name="page" type="java.lang.Integer"/>
        <form-property name="destinationPhoneNumber" type="java.lang.Integer" />
        <form-property name="message" type="java.lang.String" />
        <form-property name="charCount" type="java.lang.String" />        
        <form-property name="method" type="java.lang.String" />
      </form-bean>
      
	  <!-- ================= FIND PERSON FORM ===================-->
	  <form-bean name="findPersonForm"
	  	type="org.apache.struts.validator.DynaValidatorForm"
	    dynamic="true">
	    	<form-property name="name" type="java.lang.String"/>
	    	<form-property name="startIndex" type="java.lang.String"/>
	    	<form-property name="page" type="java.lang.Integer" initial="0"/>     		    		
			<form-property name="viewPhoto" type="java.lang.String"/>
			<form-property name="roleType" type="java.lang.String"/>
			<form-property name="departmentId" type="java.lang.Integer" />
			<form-property name="degreeType" type="java.lang.String"/>
			<form-property name="degreeId" type="java.lang.Integer"/>
	  </form-bean> 	         

      <form-bean name="homepageForm" 
                 type="org.apache.struts.validator.DynaValidatorForm"
                 dynamic="true">
     	<form-property name="page" type="java.lang.Integer"/>
        <form-property name="activated" type="java.lang.String" />
        <form-property name="name" type="java.lang.String" />
        <form-property name="showUnit" type="java.lang.String" />
        <form-property name="showCategory" type="java.lang.String" />
        <form-property name="showPhoto" type="java.lang.String" />
        <form-property name="showEmail" type="java.lang.String" />
        <form-property name="showTelephone" type="java.lang.String" />
        <form-property name="showWorkTelephone" type="java.lang.String" />
        <form-property name="showMobileTelephone" type="java.lang.String" />
        <form-property name="showAlternativeHomepage" type="java.lang.String" />
        <form-property name="showResearchUnitHomepage" type="java.lang.String" />
        <form-property name="showCurrentExecutionCourses" type="java.lang.String" />
        <form-property name="showActiveStudentCurricularPlans" type="java.lang.String" />
        <form-property name="showAlumniDegrees" type="java.lang.String" />
        <form-property name="researchUnitHomepage" type="java.lang.String" />
        <form-property name="researchUnit" type="java.lang.String" />
        <form-property name="showCurrentAttendingExecutionCourses" type="java.lang.String" />
      </form-bean>
      
      <!-- ================= PARKING REQUEST FORM =================== -->
      <form-bean name="parkingForm" type="org.apache.struts.validator.DynaValidatorForm" dynamic="true">
		<form-property name="driverLicense" type="java.lang.Boolean"/>
		<form-property name="registry1" type="java.lang.Boolean"/>
		<form-property name="insurance1" type="java.lang.Boolean"/>		    		
		<form-property name="Id1" type="java.lang.Boolean"/>
		<form-property name="declaration1" type="java.lang.Boolean"/>
		<form-property name="registry2" type="java.lang.Boolean"/>
		<form-property name="insurance2" type="java.lang.Boolean"/>
		<form-property name="Id2" type="java.lang.Boolean"/>
		<form-property name="declaration2" type="java.lang.Boolean"/>
        <form-property name="ownVehicle1" type="java.lang.Boolean"/>
        <form-property name="ownVehicle2" type="java.lang.Boolean"/>  
	  </form-bean> 	
      			
    </form-beans>

    <!-- ========== Global Exception Definitions ============================== -->
	<global-exceptions>
        <exception
			type="java.lang.Exception"
			key="error.Exception"
            handler="net.sourceforge.fenixedu.presentationTier.config.FenixContainerExceptionHandler"
			/>
		<exception
			type="net.sourceforge.fenixedu.applicationTier.Servico.exceptions.NotAuthorizedException"
			key="error.NotAuthorized"
			handler="net.sourceforge.fenixedu.presentationTier.config.FenixContainerExceptionHandler"
			/>
		<exception type="net.sourceforge.fenixedu.domain.exceptions.DomainException" 
			key="" 
			handler="net.sourceforge.fenixedu.presentationTier.config.FenixDomainExceptionHandler"/> 
	</global-exceptions>
    
    <!-- ========== Global Forward Definitions =============================== -->
    <global-forwards type="org.apache.struts.action.ActionForward">
	  <forward name="index" path="index.do" redirect="true"/>
      <forward name="firstPage" path="/index.do"/>
      <forward name="logoff" path="/logoff.do" contextRelative="true"/>
      <forward name="redirect" path="/redirect.do" contextRelative="true"/>
    </global-forwards>
    
    <!-- ========== Action Mapping Definitions =============================== -->
    <action-mappings type="org.apache.struts.action.ActionMapping">
      <!-- page fronting actions -->
      <action path="/changePasswordForward" type="net.sourceforge.fenixedu.presentationTier.Action.base.FenixForwardAction" forward="/changePassword.jsp"/>
<!--      <action path="/home" forward="/switchAction.do?prefix=&amp;page=/mainPortalPage.jsp"/>
-->
      <action path="/switchAction" type="org.apache.struts.actions.SwitchAction" />

	<action path="/voidAction" type="net.sourceforge.fenixedu.presentationTier.Action.commons.VoidAction" name="voidForm">
      <!-- form is not used -->
		<forward name="Success" path="/teacher/teacherInformation.do?method=prepareEdit&amp;page=0" contextRelative="true" redirect="true"/>
	</action>



	  <!-- Action for home portal -->
      <action path="/home" forward="/switchAction.do?prefix=&amp;page=/home.do"/>
      
      <action path="/switchAction" type="net.sourceforge.fenixedu.presentationTier.Action.base.FenixSwitchAction" />

     
      <action path="/index"
      		  type="net.sourceforge.fenixedu.presentationTier.Action.person.MainPage">
      		<forward name="ShowWelcomePage" path="/personMainPage.jsp"/>
      </action>
     
      <!-- Action for Visualization Of the Person's Personal Information -->
      <action path="/visualizePersonalInfo"
             input="personMainPage.jsp"
      	      type="net.sourceforge.fenixedu.presentationTier.Action.person.VisualizePersonalInfoAction">
      	  <forward name="Success" path="/visualizePersonalInfo.jsp"/>      	      
      </action>


      
      <!-- Action to Prepare the Change of the Candidate's Application Information -->
      <action path="/changePersonalInfoDispatchAction"
	     attribute="changePersonalInfoForm"
              name="changePersonalInfoForm"
             input="/changePersonalInfo.jsp"
	      validate="true"
		 parameter="method"
		     scope="request"
      	      type="net.sourceforge.fenixedu.presentationTier.Action.person.ChangePersonalInfoDispatchAction">
      	  <forward name="Success" path="/changeSuccess.jsp"/>
      	  <forward name="prepareReady" path="/changePersonalInfo.jsp"/>
      </action>

      <!-- Action to Change Candidate's Password -->
      <action path="/changePasswordForm"
      	      attribute="changePasswordForm"
      	      name="changePasswordForm"
              type="net.sourceforge.fenixedu.presentationTier.Action.person.ChangePersonPasswordAction"
              input="/changePassword.jsp"
              scope="request">
  	  <exception type="net.sourceforge.fenixedu.presentationTier.Action.exceptions.InvalidPasswordActionException"
				 key="resources.Action.exceptions.InvalidPasswordActionException"
                 handler="net.sourceforge.fenixedu.presentationTier.config.FenixErrorExceptionHandler"
                 />
  	  <exception type="net.sourceforge.fenixedu.presentationTier.Action.exceptions.FenixActionException"
				 key="resources.Action.exceptions.FenixActionException"
                 handler="net.sourceforge.fenixedu.presentationTier.config.FenixErrorExceptionHandler"
                 />

        <forward name="Success" path="/changePasswordSuccess.jsp"/>
      </action>

	  <action path="/readQualifications"
	  		  scope="request"
	  		  type="net.sourceforge.fenixedu.presentationTier.Action.person.ReadQualificationsAction">
  		  <forward name="show-form" path="view-qualifications"/>
  	  </action>

	  <!-- Action to manage a Qualification -->
   	  <action path="/qualificationForm"
		   	  name="qualificationForm"
		   	  input="/qualificationForm.do?method=prepareEdit&amp;page=0"
   	          type="net.sourceforge.fenixedu.presentationTier.Action.person.QualificationAction"
   	          parameter="method"
   	          scope="request"
   	          validate="true"
   	          className="net.sourceforge.fenixedu.presentationTier.mapping.framework.CRUDMapping"> 
		<set-property property="editService" value="EditQualification"/>
 		<set-property property="deleteService" value="DeleteQualification"/>
 		<set-property property="readService" value="ReadQualification"/>
  		<set-property property="oidProperty" value="idInternal"/>
    	<set-property property="requestAttribute" value="infoQualification" />
    	<set-property property="infoObjectClassName" value="net.sourceforge.fenixedu.dataTransferObject.person.InfoQualification" />
 		<forward name="show-form" path="edit-qualification"/> 
 		<forward name="successfull-edit" path="/readQualifications.do?page=0"/> 
   		<forward name="successfull-read" path="/readQualifications.do?page=0"/>
   		<forward name="successfull-delete" path="/readQualifications.do?page=0"/>
 	   </action>

		<!-- Action to send a SMS -->
		<action path="/sendSms"
			type="net.sourceforge.fenixedu.presentationTier.Action.person.SendSmsDispatchAction"
			parameter="method"
			scope="request"
			name="sendSmsForm"
			input="/sendSms.do?method=prepare&amp;page=0"
		>
			<exception type="net.sourceforge.fenixedu.presentationTier.Action.exceptions.FenixActionException"
					key="resources.Action.exceptions.FenixActionException"
					handler="net.sourceforge.fenixedu.presentationTier.config.FenixErrorExceptionHandler"/>							
			<forward name="start" path="df.page.sendSms"/>
			<forward name="error" path="df.page.sendSmsError"/>		
		</action>

		<action path="/viewSmsDeliveryReports"
			type="net.sourceforge.fenixedu.presentationTier.Action.person.ViewSmsDeliveryReportsAction"
			scope="request"
		>
			<exception type="net.sourceforge.fenixedu.presentationTier.Action.exceptions.FenixActionException"
					key="resources.Action.exceptions.FenixActionException"
					handler="net.sourceforge.fenixedu.presentationTier.config.FenixErrorExceptionHandler"/>							
			<forward name="start" path="df.page.viewSmsDeliveryReports"/>	
		</action>
		
		<!-- ========== FIND PERSON MANAGEMENT ========== -->
		<action path="/findPerson"
			type="net.sourceforge.fenixedu.presentationTier.Action.person.FindPersonAction"
			parameter="method"
			scope="request"
			name="findPersonForm"
			input="/findPerson.do?method=prepareFindPerson&amp;page=0"
			>
			<exception type="net.sourceforge.fenixedu.presentationTier.Action.exceptions.FenixActionException"
					key="resources.Action.exceptions.FenixActionException"
					handler="net.sourceforge.fenixedu.presentationTier.config.FenixErrorExceptionHandler"/>				
			<forward name="prepareFindPerson" path="/findPerson.do?method=prepareFindPerson&amp;page=0"/>
			<forward name="findPerson" path="findPerson"/>
			<forward name="displayPerson" path="displayPerson"/>
		</action>
		
		<action path="/preparePerson"
			type="net.sourceforge.fenixedu.presentationTier.Action.person.FindPersonAction"
			parameter="method"
			scope="request"
			name="findPersonForm"
			input="findPerson"
			>
			<forward name="findPerson" path="findPerson"/>
			
		</action>

	<!-- ========== VIEW PHOTO ========== -->
		<action path="/viewPhoto"
			type="net.sourceforge.fenixedu.presentationTier.Action.person.ViewPhotoAction"
			>
		</action>		

		<action path="/retrievePersonalPhoto"
			type="net.sourceforge.fenixedu.presentationTier.Action.person.RetrievePersonalPhotoAction"
			parameter="method"
			>
		</action>				
		
        <!-- ======== RENDERERS =========== -->
        <action path="/domain/view" type="net.sourceforge.fenixedu.presentationTier.renderers.actions.ViewObjectAction">
          <forward name="show" path="domain.view"/>
        </action>						

        <action path="/manageHomepage"
        		type="net.sourceforge.fenixedu.presentationTier.Action.person.ManageHomepageDA"
        		name="homepageForm"
        		scope="request"
	        		parameter="method"
        		input="/manageHomepage.do?method=prepare">
          <forward name="show-manage-homepage" path="show-manage-homepage"/>
        </action>
        <!-- ======== PARKING =========== -->
        <action path="/parking"
        		type="net.sourceforge.fenixedu.presentationTier.Action.person.ParkingDispatchAction"
        		scope="request"
        		parameter="method"
        		name="parkingForm"
        		validate="false"
        		input="/parking.do?method=prepareEditParking&amp;page=0">
          <forward name="prepareParking" path="prepare-parking"/>
          <forward name="editParkingRequest" path="edit-parking-request"/>
        </action>               
    </action-mappings>
    
    <!-- ========== Controller Configuration ================================ -->
    <controller processorClass="net.sourceforge.fenixedu.presentationTier.processor.FenixRequestProcessorWithTiles"/>
    
    <!-- ========== Message Resources Definitions ============================ -->
   	<message-resources parameter="resources.GlobalResources" key="GLOBAL_RESOURCES" null="false"/>
    <message-resources parameter="resources.MessagingResources" key="MESSAGING_RESOURCES" null="false"/>
    <message-resources parameter="resources.ApplicationResources" key="DEFAULT" null="false"/>
    <message-resources parameter="resources.EnumerationResources" key="ENUMERATION_RESOURCES" null="false"/>
    <message-resources parameter="resources.HomepageResources" key="HOMEPAGE_RESOURCES" null="false"/>
    <message-resources parameter="resources.ParkingResources" key="PARKING_RESOURCES" null="false"/>
    

    <!-- ========== Plug Ins Configuration ================================= -->
    <plug-in className="org.apache.struts.validator.ValidatorPlugIn">
      <set-property property="pathnames" 
                    value="/WEB-INF/validator-rules.xml,/WEB-INF/fenix-validator-rules.xml,/WEB-INF/conf/validation-person.xml"/>
    </plug-in>
    <plug-in className="net.sourceforge.fenixedu.renderers.plugin.RenderersPlugin">
	    <set-property property="config" 
	                  value="/WEB-INF/fenix-renderers-config.xml"
	    />    
	</plug-in>    
    <plug-in className="org.apache.struts.tiles.TilesPlugin" >
		<set-property property="definitions-config"
					  value="/WEB-INF/tiles/layouts/tiles-layout-definitions.xml,
					  		 /WEB-INF/tiles/person/tiles-person-pages-definitions.xml,
					  		 /WEB-INF/tiles/person/tiles-person-definitions.xml,
					  		 /WEB-INF/tiles/teacher/tiles-teacher-definitions.xml,
					  		 /WEB-INF/tiles/teacher/tiles-teacher-pages-definitions.xml,
					  		 /WEB-INF/tiles/layouts/tiles-layout-definitions.xml"
		/>		            	     
		<set-property property="moduleAware" value="true" />
		<set-property property="definitions-parser-validate" value="true" />
	</plug-in>    
</struts-config>

